<!DOCTYPE html>
<html>
  <head>
    <meta charset='utf-8'>
    <title>First Post | Out of Memory</title>
    <link href="/style/normalize.css" rel="stylesheet" type="text/css" /><link href="/style/all.css" rel="stylesheet" type="text/css" />
    <script src="/script/all.js" type="text/javascript"></script>
  </head>
  <body class='index'>
    <div id='wrap'>
      <h2>
        <a href="/2014/04/26/transfer-to-middleman.html">Transfer to MiddleMan</a>
        <span>
          Apr 26
        </span>
      </h2>
      <p><a href="http://jekyllrb.com/">Jekyll</a> みたいな静的サイトジェネレーターで「<a href="http://middlemanapp.com/">MiddleMan</a>」というのを発見し、ブログ以外にも普段の仕事なんかでも使えるかなと思って、切り替えてみた。で、また色々つっかえたので書いとく。</p>
      
      <p>つっかえた原因は、MiddleManのせいではなく、GithubPagesの仕様をちゃんと理解していなかったからだった。</p>
      
      <p>GitHubPagesは、そのリポジトリがProjectのサイトなのか、UserまたはOrganizationのサイトなのかによって、若干仕様が違うらしい。Projectサイトの場合は、<code>gh-pages</code>ブランチのコンテンツが表示され、User/Organizationサイトの場合は、<code>master</code>ブランチのコンテンツが表示されるらしい<sup id="fnref:1"><a href="#fn:1" class="footnote">1</a></sup>。</p>
      
      <p>今回、middleman-deployを使って、<code>config.rb</code>で<code>gh-pages</code>ブランチをdeploy先に指定していたせいでサイトが表示されなくて困った。
      前回までも、上記の仕様を知らずに、<code>gh-pages</code>ブランチを使っていたんだけど、どうもJekyllを使っていたからGitHub側できちんとdeployしてくれて表示ができていたということらしい。</p>
      
      <p>変な仕様だなと思うんだけど、まぁ確かにプロジェクトの方はメイン（master）はプロジェクトのソースコードで、ユーザー／Organizationの方はサイトがメインと考えられるから、まぁ納得。でも、ちょっと気づきにくいなぁ。</p>
      
      <p>あとは、<code>confg.rb</code>で</p>
      
      <p><code>rb
      Time.zone = "Tokyo"
      </code></p>
      
      <p>としてなくて、今書いてる記事がbuildされない（多分深夜だったからUTC時間では未来だと判定されたのだろう…）など、あったが、まぁ、まぁ。なにはともあれ、とりあえず公開までできたので、色々試していこうと思う。Jekyllでは、Octpressからコード整形プラグイン引っこ抜くなど、それなりに時間かかったんだけど、また振り出しです。がんばろー・・・っと。</p>
      
      <p>注：なんだか、前回は「ですます調」で書いたんだけど、なんか疲れたのでこんな感じで・・・</p>
      <div class="footnotes">
        <ol>
          <li id="fn:1">
            <p>参考 <a href="http://blog.coiney.com/2013/06/21/host-middleman-blog-on-github/">middleman-blogをgithubでホストする / Coiney Developer Blog</a> <a href="#fnref:1" class="reversefootnote">&#8617;</a></p>
          </li>
        </ol>
      </div>
      <h2>
        <a href="/2014/04/13/first-post.html">First Post</a>
        <span>
          Apr 13
        </span>
      </h2>
      <p>ブログなんて何年ぶりかわからないけど、気になっていた<a href="http://jekyllrb.com/">Jekyll</a>の勉強がてらはじめてみることにしました。記憶からこぼれ落ちそうな内容を、書き留めておく場所にしようかな？と思ったので、タイトルは「Out of My Memory」としてみます。</p>
      
      <p>さっそく、jekyll newした時に問題発生したので書き留めておきます。</p>
      
      <p>```sh
      $ jekyll new mysite</p>
      
      <p>SafeYAML Warning
        —————-</p>
      
      <p>You appear to have an outdated version of libyaml (0.1.4) installed on your system.</p>
      
      <p>Prior to 0.1.6, libyaml is vulnerable to a heap overflow exploit from malicious YAML payloads.</p>
      
      <p>For more info, see:
        https://www.ruby-lang.org/en/news/2014/03/29/heap-overflow-in-yaml-uri-escape-parsing-cve-2014-2525/</p>
      
      <p>The easiest thing to do right now is probably to update Psych to the latest version and enable
        the 'bundled-libyaml' option, which will install a vendored libyaml with the vulnerability patched:</p>
      
      <p>gem install psych – –enable-bundled-libyaml</p>
      
      <p>```</p>
      
      <p>rbenvを使っていたので、普通にrbenv installでまだ入れてなかった2.0.0を入れてから試してもダメだったので、変だと思ったのですが、
      探すと<a href="http://stackoverflow.com/questions/22919318/fix-for-prior-to-0-1-6-libyaml-is-vulnerable-to-a-heap-overflow-exploit-from-m">stackoverflow</a>に解決方法を書いてくれている人がいました。ありがたい。</p>
      
      <p>まず、ruby-buildを更新してからrubyをビルドするとうまくいくようです。</p>
      
      <p><code>sh
      $ rm -rf ~/.rbenv/plugins/ruby-build
      $ git clone https://github.com/sstephenson/ruby-build.git ~/.rbenv/plugins/ruby-build
      $ rbenv install 2.0.0-p451
      </code></p>
      
      <p>自分がどうしたか忘れましたが（さっそく…）、このあとにJekyllをインストールしてあげれば間違いないと思います。</p>
      
      <h1 id="my-first-impression-of-jekyll">My first impression of Jekyll</h1>
      
      <ul>
        <li>最初は、Gemfileに色々書いて言ってたんだけど、github-pagesというのだけ入れればよかった。</li>
        <li>Github Pagesで運用する場合はconfigにsourceの指定しても無効で、<a href="https://help.github.com/articles/using-jekyll-with-pages#configuration-overrides">必ずルートに設定を上書きされるらしい</a>。</li>
        <li>まだ１つしか記事書いてないが、全体のスタイルなどの更新と、記事の更新がcommit上で一緒くたになってしまうのが、若干気持ち悪いかなぁ…</li>
      </ul>
    </div>
  </body>
</html>
